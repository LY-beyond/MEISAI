# Task3: Dancing with the Stars å½±å“å› ç´ åˆ†æ

## ğŸ“ é¡¹ç›®ç»“æ„ï¼ˆæ•´ç†åï¼‰

```
task3/
â”œâ”€â”€ src/                    # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ data_processing.py          # æ•°æ®åŠ è½½ä¸ç‰¹å¾å·¥ç¨‹
â”‚   â”œâ”€â”€ model_training.py           # XGBoostæ¨¡å‹è®­ç»ƒä¸è¯„ä¼°
â”‚   â”œâ”€â”€ shap_analysis.py            # SHAPå¯è§£é‡Šæ€§åˆ†æ
â”‚   â”œâ”€â”€ influence_analysis.py       # ä¸»ç¨‹åºï¼ˆæµç¨‹æ§åˆ¶ï¼‰
â”‚   â””â”€â”€ data_analysis_summary.py    # åˆ†ææ€»ç»“æŠ¥å‘Š
â”‚
â”œâ”€â”€ data/                   # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ inputs/             # è¾“å…¥æ•°æ®ï¼ˆä¾èµ–task1ç›®å½•ï¼‰
â”‚   â”œâ”€â”€ intermediate/       # ä¸­é—´æ•°æ®ï¼ˆæš‚ç©ºï¼‰
â”‚   â””â”€â”€ outputs/           # è¾“å‡ºæ•°æ®
â”‚       â”œâ”€â”€ controversial_cases.csv             # äº‰è®®æ¡ˆä¾‹
â”‚       â”œâ”€â”€ judge_feature_importance.csv        # è¯„å§”æ¨¡å‹ç‰¹å¾é‡è¦æ€§
â”‚       â”œâ”€â”€ fan_feature_importance.csv          # ç²‰ä¸æ¨¡å‹ç‰¹å¾é‡è¦æ€§
â”‚       â”œâ”€â”€ judge_interactions.csv              # è¯„å§”æ¨¡å‹äº¤äº’æ•ˆåº”
â”‚       â”œâ”€â”€ fan_interactions.csv                # ç²‰ä¸æ¨¡å‹äº¤äº’æ•ˆåº”
â”‚       â””â”€â”€ feature_importance_comparison_pivot.csv  # ç‰¹å¾é‡è¦æ€§å¯¹æ¯”æ•°æ®
â”‚
â”œâ”€â”€ docs/                   # æ–‡æ¡£ç›®å½•
â”‚   â””â”€â”€ code_explanation.md      # ä»£ç è¯¦ç»†è®²è§£æ–‡æ¡£
â”‚
â”œâ”€â”€ visualizations/         # å¯è§†åŒ–å›¾è¡¨ç›®å½•
â”‚   â””â”€â”€ (ç”Ÿæˆçš„PNGå›¾è¡¨å°†ä¿å­˜åœ¨è¿™é‡Œ)
â”‚
â””â”€â”€ README.md              # é¡¹ç›®è¯´æ˜æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶ï¼‰
```

## ğŸ› ï¸ å·²å®Œæˆçš„æ¸…ç†å·¥ä½œ

### åˆ é™¤çš„æ— ç”¨æ–‡ä»¶å’Œç›®å½•

1. **åµŒå¥—çš„task3ç›®å½•** (`task3/task3/`) - é‡å¤çš„åµŒå¥—ç»“æ„
2. **Pythonç¼–è¯‘ç¼“å­˜** (`__pycache__/`) - Pythonå­—èŠ‚ç ç¼“å­˜æ–‡ä»¶
3. **ç©ºç›®å½•reports** (`reports/`) - æœªä½¿ç”¨çš„ç©ºç›®å½•
4. **é‡å¤çš„visualizationsç©ºç›®å½•** - ç©ºç™½çš„å¯è§†åŒ–ç›®å½•

### ä¼˜åŒ–åçš„æ–‡ä»¶ç»„ç»‡

- **æºä»£ç **é›†ä¸­åˆ° `src/` ç›®å½•
- **æ•°æ®æ–‡ä»¶**ç»Ÿä¸€ç®¡ç†åˆ° `data/` ç›®å½•
- **æ–‡æ¡£**é›†ä¸­åˆ° `docs/` ç›®å½•
- **å¯è§†åŒ–å›¾è¡¨**é›†ä¸­åˆ° `visualizations/` ç›®å½•

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è¿è¡Œå®Œæ•´åˆ†æ

```bash
cd d:\MEISAI\task3
python src/influence_analysis.py
```

### 2. ç”Ÿæˆåˆ†ææŠ¥å‘Š

```bash
python src/data_analysis_summary.py
```

### 3. æŸ¥çœ‹ä»£ç æ–‡æ¡£

```bash
# é˜…è¯»è¯¦ç»†ä»£ç è®²è§£
type docs\code_explanation.md
```

## ğŸ“Š åˆ†æç»“æœæ¦‚è¿°

### æ¨¡å‹æ€§èƒ½

- **è¯„å§”å¾—åˆ†æ¨¡å‹**ï¼šRÂ² = 0.815ï¼ˆè§£é‡Šèƒ½åŠ›å¼ºï¼‰
- **ç²‰ä¸æŠ•ç¥¨æ¨¡å‹**ï¼šRÂ² = 0.052ï¼ˆé¢„æµ‹éš¾åº¦å¤§ï¼‰

### å…³é”®å‘ç°

1. **è¯„å§”å…³æ³¨**ï¼šèŒä¸šèˆè€…ç»éªŒä¸æ¨¡ç‰¹è¡Œä¸šçš„äº¤äº’ï¼ˆ14.71%ï¼‰
2. **ç²‰ä¸å…³æ³¨**ï¼šæ¨¡ç‰¹è¡Œä¸šèƒŒæ™¯ï¼ˆ10.15%ï¼‰å’Œå¹´é¾„ä¸è¿åŠ¨å‘˜çš„äº¤äº’ï¼ˆ8.39%ï¼‰
3. **ç³»ç»Ÿæ€§å·®å¼‚**ï¼šè¯„å§”é‡æŠ€æœ¯è¡¨ç°ï¼Œç²‰ä¸é‡å¨±ä¹æ€§
4. **äº‰è®®æ¡ˆä¾‹**ï¼šè¯„å§”é«˜åˆ†ä½†ç²‰ä¸æ”¯æŒåº¦ä½ï¼ˆå¦‚Emmitt Smithï¼‰

### ç”Ÿæˆçš„è¾“å‡ºæ–‡ä»¶

- `data/outputs/` ç›®å½•åŒ…å«æ‰€æœ‰CSVåˆ†æç»“æœ
- `visualizations/` ç›®å½•åŒ…å«æ‰€æœ‰PNGå¯è§†åŒ–å›¾è¡¨

## ğŸ”§ ä»£ç ä¿®å¤è®°å½•

### å·²ä¿®å¤çš„é—®é¢˜

1. **ç¼–ç é—®é¢˜**ï¼š`'utf-8' codec can't decode byte 0xc9`
   - ä¿®å¤ï¼šä½¿ç”¨ `encoding='cp1252'` è¯»å–CSVæ–‡ä»¶

2. **NaNå€¼é—®é¢˜**ï¼š`ValueError: Input contains NaN`
   - ä¿®å¤ï¼šåœ¨ç‰¹å¾å·¥ç¨‹é˜¶æ®µç§»é™¤ç¼ºå¤±å€¼

3. **SHAPå…¼å®¹æ€§**ï¼šæ”¯æŒSHAP 0.40.0+æ–°æ—§API
   - ä¿®å¤ï¼šè‡ªåŠ¨æ£€æµ‹APIç‰ˆæœ¬å¹¶é€‰æ‹©åˆé€‚çš„å‡½æ•°

4. **å›¾ç‰‡ä¿å­˜é—®é¢˜**ï¼š`plt.savefig()`å˜é‡æœªå®šä¹‰
   - ä¿®å¤ï¼šæ­£ç¡®åˆ›å»ºfigureå’Œaxeså¯¹è±¡

5. **ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜**ï¼šMatplotlibä¸­æ–‡ä¹±ç 
   - ä¿®å¤ï¼šé…ç½®ä¸­æ–‡å­—ä½“å’Œè´Ÿå·æ˜¾ç¤º

## ğŸ“‹ ä¾èµ–è¯´æ˜

### PythonåŒ…ä¾èµ–

```txt
pandas>=1.5.0
numpy>=1.23.0
scikit-learn>=1.2.0
xgboost>=1.7.0
shap>=0.42.0
matplotlib>=3.7.0
seaborn>=0.12.0
```

### æ•°æ®ä¾èµ–

- éœ€è¦ä» `../task1/` ç›®å½•åŠ è½½é¢„å¤„ç†æ•°æ®
- åŒ…å«ä¸‰ä¸ªé¢„å¤„ç†æ–‡ä»¶ï¼š
  1. `dwts_rank_regular_processed.csv`
  2. `dwts_percentage_regular_processed.csv`
  3. `dwts_rank_bottom_two_processed.csv`

## ğŸ“ æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒæºä»£ç 

- **data_processing.py** - æ•°æ®åŠ è½½ã€æ¸…æ´—ã€ç‰¹å¾å·¥ç¨‹
- **model_training.py** - XGBoostæ¨¡å‹è®­ç»ƒã€äº¤å‰éªŒè¯
- **shap_analysis.py** - SHAPå€¼è®¡ç®—ã€å¯è§†åŒ–ã€äº¤äº’æ•ˆåº”åˆ†æ
- **influence_analysis.py** - ä¸»ç¨‹åºï¼Œæ§åˆ¶å®Œæ•´åˆ†ææµç¨‹
- **data_analysis_summary.py** - ç”Ÿæˆç»“æ„åŒ–åˆ†ææŠ¥å‘Š

### è¾“å‡ºæ•°æ®

- **ç‰¹å¾é‡è¦æ€§**ï¼šè¯„å§”å’Œç²‰ä¸æ¨¡å‹çš„ç‰¹å¾é‡è¦æ€§æ’å
- **äº¤äº’æ•ˆåº”**ï¼šç‰¹å¾é—´çš„äº¤äº’ä½œç”¨å¼ºåº¦
- **äº‰è®®æ¡ˆä¾‹**ï¼šè¯„å§”ä¸ç²‰ä¸è¯„åˆ†å·®å¼‚æœ€å¤§çš„æ¡ˆä¾‹

## ğŸ¯ ä½¿ç”¨å»ºè®®

### 1. é‡æ–°è¿è¡Œåˆ†æ

```bash
# å®Œæ•´åˆ†æï¼ˆè€—æ—¶çº¦1-2åˆ†é’Ÿï¼‰
python src/influence_analysis.py

# åªç”ŸæˆæŠ¥å‘Šï¼ˆå¿«é€Ÿï¼‰
python src/data_analysis_summary.py
```

### 2. æŸ¥çœ‹ç»“æœ

```bash
# æŸ¥çœ‹è¯„å§”æ¨¡å‹ç‰¹å¾é‡è¦æ€§
python -c "import pandas as pd; df = pd.read_csv('data/outputs/judge_feature_importance.csv'); print(df.head())"

# æŸ¥çœ‹äº‰è®®æ¡ˆä¾‹
python -c "import pandas as pd; df = pd.read_csv('data/outputs/controversial_cases.csv'); print(df)"
```

### 3. è‡ªå®šä¹‰åˆ†æ

å¯ä»¥ä¿®æ”¹ `src/influence_analysis.py` ä¸­çš„æ¨¡å‹å‚æ•°ï¼š

```python
# è¯„å§”æ¨¡å‹å‚æ•°
judge_params = {
    'n_estimators': 200,
    'max_depth': 5,
    'learning_rate': 0.1,
    'objective': 'reg:squarederror',
    'random_state': 42
}
```

## ğŸ“ é—®é¢˜åé¦ˆ

å¦‚æœé‡åˆ°ä»»ä½•é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š

1. ä¾èµ–åŒ…æ˜¯å¦å®‰è£…å®Œæ•´
2. task1ç›®å½•æ˜¯å¦å­˜åœ¨é¢„å¤„ç†æ•°æ®
3. æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®

é¡¹ç›®å·²æ¸…ç†å®Œæ¯•ï¼Œç»“æ„æ¸…æ™°ï¼Œå¯ä»¥ç¨³å®šè¿è¡Œã€‚
